<!doctype html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Macaulay in Browser</title>
    <meta name="description" content="boxedwine emulator">
    <meta name="keywords" content="emulator,wine,windows,x86,PC,emscripten,web assembly,wasm,boxedwine">
    <meta name="author" content="James Bryant, Kevin O'Dwyer, Yanshu Wang">
    <link rel="stylesheet" type="text/css" href="boxedwine.css">
    
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        font-family: sans-serif;
        box-sizing: border-box;
        overflow: hidden; /* Disables window scrollbar */
      }

      h1 {
        text-align: center;
        height: 50px; /* Fixed height for header */
        margin: 0;
        padding-top: 15px;
        box-sizing: border-box;
      }

      .container {
        display: flex;
        gap: 20px;
        padding: 10px 20px 20px 20px;
        /* Height = Viewport - Header Height */
        height: calc(100vh - 60px); 
        box-sizing: border-box;
        align-items: stretch;
      }

      .frame {
        border: 2px solid #ccc;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        background-color: #fcfcfc;
      }

      #emulator-frame {
        flex: 0 0 auto; /* Do not grow/shrink, fit content */
        overflow: hidden; /* Does not move/scroll */
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
      }

      .instruction-content {
        flex: 1; /* Takes remaining width */
        overflow-y: auto; /* ENABLES IN-FRAME SCROLLING */
      }

      .instruction-content img {
        max-width: 100%;
        height: auto;
        border: 1px solid #ddd;
        margin: 10px 0;
        display: block;
      }
      
      .emscripten_border {
        max-width: 100%;
        overflow: hidden;
      }

      @media (max-width: 900px) {
        html, body { height: auto; overflow: auto; }
        .container { display: block; height: auto; }
        .frame { margin-bottom: 20px; }
        #emulator-frame { width: auto; }
      }
    </style>
  </head>
  <body>

  <h1>Macaulay in Browser</h1>

  <div class="container">
    
    <div class="frame" id="emulator-frame">
      <h2 style="margin-top:0;">Emulator</h2>
      <div id="loading">
        <figure id="spinner" style="overflow: visible;">
           <div class="spinner" style="margin-top: .5em; margin-left: auto; margin-right: auto;"></div>
        </figure>
        <div class="emscripten" id="status">Downloading...</div>
        <div class="emscripten">
           <progress value="0" max="100" id="progress"></progress>
        </div>
      </div>

      <div>
          <div class="emscripten">
              <button id="startbtn" style="display: none" onclick="start()">Start</button>
              <button id="uploadbtn" style="display: none" onclick="document.getElementById('upload').click()" >Add File(s)</button>
              <input style="display: none" id="upload" name="upload" onclick="document.getElementById('uploadbtn').click();" onchange="startWithFiles(event.target.files);" type="file" multiple />
              <button id="downloadbtn" style="display: none" onclick="buildGetFilesModal();">Get File(s)</button>
              <a style="display: none" id="modalLink" href="#openModal">Open</a>
              <a style="display: none" id="modalLinkExe" href="#openModalExe">Open</a>

            <span id="sound-checkbox" style="display: none">
                <input type="checkbox" id="soundToggle" onclick="toggleSound();" />Enable Sound
            </span>
            <br><br>
            <input type="checkbox" id="pointerLock" checked>Lock/hide mouse pointer
            <input type="checkbox" id="showConsole" onclick="toggleConsole();" checked>Show console
            <input type="checkbox" id="resize">Resize canvas
          </div>
          
          <hr>

          <div id="dropzone">
              <div class="emscripten_border">
                  <canvas class="emscripten" id="canvas" oncontextmenu="event.preventDefault()"></canvas>
              </div>
          </div>
          
          <div>
              <textarea class="emscripten" id="output" rows="8" style="display: none; width: 100%; box-sizing: border-box;"></textarea>
          </div>

          <div id="openModal" class="modalDialog">
              <div> <a href="#close" title="Close" class="close" onclick="closeGetFilesModal();">X</a>
                  <div>
                      <h3>Get File(s)</h3>
                      <input id="selectedItem" type="text" size="50" readonly>
                      <button onclick="extract();">Get</button>
                  </div>
                  <div id="tree" class="scroll-style">
                  </div>
                  <div>
                      <h3 id="loadStatus">Loading...</h3>
                  </div>
              </div>
          </div>
          <div id="openModalExe" class="modalDialog">
              <div> <a id="openModalExeClick" href="#close" title="Close" class="close">X</a>
                  <div>
                      <h3>Execute</h3>
                      <div id="message"></div>
                      <div id="items" class="scroll-style"></div>
                  </div>
              </div>
          </div>
      </div>
    </div>

    <div class="frame instruction-content">
      <h2 style="margin-top:0;">How to run?</h2>
      <p>1. First Click this <a href="index.html?app=MacWin32&p=DISK1/SETUP.exe">link</a> to start the installer.</p>
      <img src="install.png" alt="installation started">
      
      <p>2. Follow the install instructions.</p>
      <img src="install_in_progress.png" alt="installation in progress">
      
      <p>3. After the installation is finished, it will pop up multiple windows.</p>
      <img src="finished.png" alt="installation finished">
      
      <p>4. Then Click this <a href="index.html?p=start.exe">link</a> and type <strong>start Macaulay.exe</strong> in the terminal.</p>
      <img src="start.png" alt="start Macaulay">
      
      <p>5. Macaulay should start.</p>
      <img src="launched.png" alt="Macaulay launched">
      
      <hr>
      <h2>Debug Trick:</h2>
      <ul>
        <li><a href="index.html?p=explorer.exe">Launch Windows File Explorer</a>. The C drive path is <strong>\home\username\.wine\drive_c</strong></strong></strong></li>
        <li><a href="index.html?p=notepad.exe">Launch Notepad</a>.</li>
        <li><a href="index.html?p=start.exe">Launch Terminal</a>.</li>
        <li><a href="index.html?p=winecfg.exe">Launch Wine Configure Tools</a>.</li>
      </ul>
      <hr>
      <h2>Credit:</h2>
      <ul>
        <li><a href="https://www.math.columbia.edu/~bayer/Macaulay/">Macaulay</a></li>
        <li><a href="https://github.com/danoon2/Boxedwine">Boxedwine</a></li>
        <li><a href="license.txt">Boxedwine License</a></li>
      </ul>
    </div>

  </div> <script src="boxedwine-shell.js"></script>
  <script async type="text/javascript" src="boxedwine.js"></script>
  </body>
</html>
